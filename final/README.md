# –°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –ª–∏—á–Ω—ã—Ö —Ç—Ä–∞—Ç

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É—á—ë—Ç–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ –ª–∏—á–Ω—ã—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π Google –¢–∞–±–ª–∏—Ü.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
Google Sheets (Apps Script)
v
Gateway (HTTP :8080)
v
Auth | Ledger
|
PostgreSQL + Redis
```

## –°–µ—Ä–≤–∏—Å—ã

- **Gateway** - HTTP API —à–ª—é–∑, –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –æ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç JWT, –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –≤ gRPC —Å–µ—Ä–≤–∏—Å—ã
- **Auth** - —Å–µ—Ä–≤–∏—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –ª–æ–≥–∏–Ω, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è JWT)
- **Ledger** - –æ—Å–Ω–æ–≤–Ω–æ–π –±–∏–∑–Ω–µ—Å-—Å–µ—Ä–≤–∏—Å (—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –±—é–¥–∂–µ—Ç—ã, –æ—Ç—á—ë—Ç—ã, CSV –∏–º–ø–æ—Ä—Ç/—ç–∫—Å–ø–æ—Ä—Ç)

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker –∏ Docker Compose
- Go 1.21+ (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose

```bash
cd final

# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
docker-compose ps

# –õ–æ–≥–∏
docker-compose logs -f gateway
```

–°–µ—Ä–≤–∏—Å—ã –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã:
- Gateway API: http://localhost:8080
- Health check: http://localhost:8080/health

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ PostgreSQL –∏ Redis:
```bash
docker-compose up -d postgres redis
```

2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ (—Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ init-db.sql)

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã:
```bash
# Auth
cd auth
go run ./cmd/auth

# Ledger (–≤ –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
cd ledger
go run ./cmd/ledger

# Gateway (–≤ —Ç—Ä–µ—Ç—å–µ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
cd gateway
go run ./cmd/gateway
```

## API

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

```bash
# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
curl -X POST http://localhost:8080/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{"email": "test@example.com", "password": "password123"}'

# –û—Ç–≤–µ—Ç: {"user_id": 1, "token": "eyJhbG..."}

# –í—Ö–æ–¥
curl -X POST http://localhost:8080/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email": "test@example.com", "password": "password123"}'
```

### –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

```bash
# –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
curl -X POST http://localhost:8080/api/transactions \
  -H "Authorization: Bearer <TOKEN>" \
  -H "Content-Type: application/json" \
  -d '{"amount": 1500, "category": "food", "description": "–û–±–µ–¥", "date": "2024-12-15"}'

# –ü–æ–ª—É—á–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
curl http://localhost:8080/api/transactions \
  -H "Authorization: Bearer <TOKEN>"

# –° —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
curl "http://localhost:8080/api/transactions?from=2024-12-01&to=2024-12-31&category=food" \
  -H "Authorization: Bearer <TOKEN>"
```

### –ë—é–¥–∂–µ—Ç—ã

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±—é–¥–∂–µ—Ç
curl -X POST http://localhost:8080/api/budgets \
  -H "Authorization: Bearer <TOKEN>" \
  -H "Content-Type: application/json" \
  -d '{"category": "food", "limit_amount": 15000, "period": "monthly"}'

# –ü–æ–ª—É—á–∏—Ç—å –±—é–¥–∂–µ—Ç—ã
curl http://localhost:8080/api/budgets \
  -H "Authorization: Bearer <TOKEN>"
```

### –û—Ç—á—ë—Ç—ã

```bash
# –ü–æ–ª—É—á–∏—Ç—å –æ—Ç—á—ë—Ç –∑–∞ –ø–µ—Ä–∏–æ–¥
curl "http://localhost:8080/api/reports?from=2024-12-01&to=2024-12-31" \
  -H "Authorization: Bearer <TOKEN>"
```

### CSV

```bash
# –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV
curl "http://localhost:8080/api/csv/export" \
  -H "Authorization: Bearer <TOKEN>"

# –ò–º–ø–æ—Ä—Ç –∏–∑ CSV (–¥–∞–Ω–Ω—ã–µ –≤ base64)
curl -X POST http://localhost:8080/api/csv/import \
  -H "Authorization: Bearer <TOKEN>" \
  -H "Content-Type: application/json" \
  -d '{"csv_data": "YW1vdW50LGNhdGVnb3J5LGRlc2NyaXB0aW9uLGRhdGUKMTUwMCxmb29kLNCe0LHQtdC0LDIwMjQtMTItMTU="}'
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google –¢–∞–±–ª–∏—Ü–∞–º–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞

1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é Google –¢–∞–±–ª–∏—Ü—É
2. –û—Ç–∫—Ä–æ–π—Ç–µ **–†–∞—Å—à–∏—Ä–µ–Ω–∏—è ‚Üí Apps Script**
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `google-apps-script/Code.gs`
4. –ò–∑–º–µ–Ω–∏—Ç–µ `API_BASE_URL` –Ω–∞ –≤–∞—à –ø—É–±–ª–∏—á–Ω—ã–π –∞–¥—Ä–µ—Å (ngrok)
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `init()`

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ –ø–æ—è–≤–∏—Ç—Å—è –º–µ–Ω—é **"üí∞ Expense Tracker"**:

- **–í–æ–π—Ç–∏ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ
- **–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é** - –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –∏–∑ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ (–°—É–º–º–∞ | –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ | –î–∞—Ç–∞)
- **–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏** - –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω–∞ –ª–∏—Å—Ç "–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏"
- **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±—é–¥–∂–µ—Ç** - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –±—é–¥–∂–µ—Ç –∏–∑ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ (–ö–∞—Ç–µ–≥–æ—Ä–∏—è | –õ–∏–º–∏—Ç | –ü–µ—Ä–∏–æ–¥)
- **–ó–∞–≥—Ä—É–∑–∏—Ç—å –±—é–¥–∂–µ—Ç—ã** - –∑–∞–≥—Ä—É–∂–∞–µ—Ç –±—é–¥–∂–µ—Ç—ã –Ω–∞ –ª–∏—Å—Ç "–ë—é–¥–∂–µ—Ç—ã"
- **–ü–æ–ª—É—á–∏—Ç—å –æ—Ç—á—ë—Ç** - –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç—á—ë—Ç –∑–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥

### –ü—Ä–∏–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã

–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Å—Ç—Ä–æ–∫—É:
| A (–°—É–º–º–∞) | B (–ö–∞—Ç–µ–≥–æ—Ä–∏—è) | C (–û–ø–∏—Å–∞–Ω–∏–µ) | D (–î–∞—Ç–∞) |
|-----------|---------------|--------------|----------|
| 1500 | food | –û–±–µ–¥ –≤ –∫–∞—Ñ–µ | 2024-12-15 |

–í—ã–¥–µ–ª–∏—Ç–µ —Å—Ç—Ä–æ–∫—É –∏ –Ω–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é".

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### Auth
- `GRPC_PORT` - –ø–æ—Ä—Ç gRPC —Å–µ—Ä–≤–µ—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 9091)
- `DATABASE_URL` - —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL
- `JWT_SECRET` - —Å–µ–∫—Ä–µ—Ç –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ JWT —Ç–æ–∫–µ–Ω–æ–≤

### Ledger
- `GRPC_PORT` - –ø–æ—Ä—Ç gRPC —Å–µ—Ä–≤–µ—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 9090)
- `DATABASE_URL` - —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL
- `REDIS_ADDR` - –∞–¥—Ä–µ—Å Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

### Gateway
- `HTTP_PORT` - –ø–æ—Ä—Ç HTTP —Å–µ—Ä–≤–µ—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 8080)
- `AUTH_GRPC_ADDR` - –∞–¥—Ä–µ—Å Auth —Å–µ—Ä–≤–∏—Å–∞
- `LEDGER_GRPC_ADDR` - –∞–¥—Ä–µ—Å Ledger —Å–µ—Ä–≤–∏—Å–∞

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

OpenAPI/Swagger —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è: `gateway/docs/swagger.yaml`

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
final/
‚îú‚îÄ‚îÄ docker-compose.yml     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker
‚îú‚îÄ‚îÄ init-db.sql            # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
‚îú‚îÄ‚îÄ README.md
‚îÇ
‚îú‚îÄ‚îÄ api/proto/             # Proto —Ñ–∞–π–ª—ã
‚îÇ   
‚îú‚îÄ‚îÄ auth/                  # –°–µ—Ä–≤–∏—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
‚îÇ
‚îú‚îÄ‚îÄ ledger/                # –°–µ—Ä–≤–∏—Å —Ñ–∏–Ω–∞–Ω—Å–æ–≤
‚îÇ
‚îú‚îÄ‚îÄ gateway/               # HTTP —à–ª—é–∑
‚îÇ
‚îî‚îÄ‚îÄ google-apps-script/    # –°–∫—Ä–∏–ø—Ç –¥–ª—è Google Sheets
    ‚îî‚îÄ‚îÄ Code.gs
```

## –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Å—Ü–µ–Ω–∞—Ä–∏—è

1. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Google –¢–∞–±–ª–∏—Ü—É, –Ω–∞–∂–∏–º–∞–µ—Ç "–í–æ–π—Ç–∏" –∏ –≤–≤–æ–¥–∏—Ç email/–ø–∞—Ä–æ–ª—å
2. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±—é–¥–∂–µ—Ç–æ–≤**: –ó–∞–ø–æ–ª–Ω—è–µ—Ç —Å—Ç—Ä–æ–∫—É —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π –∏ –ª–∏–º–∏—Ç–æ–º, –Ω–∞–∂–∏–º–∞–µ—Ç "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±—é–¥–∂–µ—Ç"
3. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π**: –ó–∞–ø–æ–ª–Ω—è–µ—Ç —Å—Ç—Ä–æ–∫–∏ —Å —Ä–∞—Å—Ö–æ–¥–∞–º–∏, –¥–æ–±–∞–≤–ª—è–µ—Ç —á–µ—Ä–µ–∑ –º–µ–Ω—é
4. **–ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç—á—ë—Ç–∞**: –ù–∞–∂–∏–º–∞–µ—Ç "–ü–æ–ª—É—á–∏—Ç—å –æ—Ç—á—ë—Ç", –≤–≤–æ–¥–∏—Ç –¥–∞—Ç—ã - –ø–æ–ª—É—á–∞–µ—Ç —Å–≤–æ–¥–∫—É —Å –ø—Ä–æ—Ü–µ–Ω—Ç–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±—é–¥–∂–µ—Ç–∞

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Go 1.24
- gRPC –¥–ª—è –º–µ–∂—Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
- PostgreSQL –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç—á—ë—Ç–æ–≤
- Gin –¥–ª—è HTTP API
- JWT –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- Docker/Docker Compose –¥–ª—è —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è
- Google Apps Script –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏

